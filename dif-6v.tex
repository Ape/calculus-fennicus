\section{Taylorin sarjat} \label{taylorin sarjat}
\alku

Kun j‰‰nnˆstermi Taylorin lauseessa \ref{Taylor} arvioidaan funktioille $\sin x$ ja $\cos x$, 
niin n‰hd‰‰n, ett‰
\begin{alignat*}{2}
\abs{\sin x -T_{2n+1}(x,0)} &\leq \frac{1}{(2n+3)!}\abs{x}^{2n+3},\quad &x\in\R, \\
\abs{\cos x -T_{2n}(x,0)} &\leq \frac{1}{(2n+2)!}\abs{x}^{2n+2},\quad &x\in\R.
\end{alignat*}
Koska $\abs{x}^n/n!\kohti 0 \ \forall x\in\R$, kun $n\kohti\infty$, niin $\forall x\in\R$
p‰tee
\[ 
\sin x = \lim_{n\kohti\infty} T_{2n+1}(x,0), \qquad \cos x = \lim_{n\kohti\infty}T_{2n}(x,0), 
\] 
eli
\[
\boxed{\begin{aligned}
\quad\sin x\ &=\ \sum_{k=0}^\infty (-1)^k\frac{x^{2k+1}}{(2k+1)!}, \quad x\in\R \quad \\
     \cos x\ &=\ \sum_{k=0}^\infty (-1)^k\frac{x^{2k}}{(2k)!}, \quad x\in\R
\end{aligned}}
\]
\begin{Def}
Jos $f$ on mielivaltaisen monta kertaa derivoituva $x_0$:ssa, niin sarja
\[
\sum_{k=0}^\infty \frac{f^{(k)}(x_0)}{k!}(x-x_0)^k 
\]
on $f$:n \kor{Taylorin sarja} $x_0$:ssa.\footnote[2]{Tapauksessa $x_0=0$ k‰ytet‰‰n Taylorin
sarjasta myˆs nimityst‰ \kor{Maclaurinin sarja}.}
\end{Def}
Taylorin sarjojen teoriassa aivan ilmeisesti keskeisin kysymys on: Milloin sarja suppenee
kohti $f(x)$:‰‰, ts. milloin p‰tee
\[
f(x)=\lim_{n\kohti\infty} T_n(x,x_0)=\sum_{k=0}^\infty \frac{f^{(k)}(x_0)}{k!}(x-x_0)^k \ ?
\]
Funktioiden $\sin x$ ja $\cos x$ kohdalla vastaus on: Aina, eli jokaisella $x\in\R$ 
(myˆs jokaisella $x_0 \in \R$). Kolmas esimerkki funktiosta, jonka Taylorin sarja suppenee 
jokaisella $x\in\R$ on eksponenttifunktio, jolle p‰tee (vrt. Luku \ref{exp(x) ja ln(x)})
\[
\boxed{\quad e^x=\sum_{k=0}^\infty \frac{x^k}{k!}, \quad x\in\R \quad}
\]
Tarkasti ottaen ym. kysymys Taylorin sarjan konvergenssista sis‰lt‰‰ kaksi erillist‰
kysymyst‰, kuten n‰hd‰‰n seuraavasta esimerkist‰.
\begin{Exa} \label{outo Taylorin sarja} Funktio
\[
f(x)=\begin{cases}
e^{-1/x^2}, \quad   &\text{kun}\ x \neq 0 \\
0\ ,                &\text{kun}\ x = 0
\end{cases}
\]
on mielivaltaisen monta kertaa derivoituva pisteess‰ $x=0$ (myˆs muualla) ja
\[
f^{(k)}(0)=0,\quad k=0,1,2,\ldots\,,
\]
joten $T_n(x,0)=0 \ \forall n$. T‰ss‰ tapauksessa siis Taylorin sarja suppenee $\forall x\in\R$,
mutta $\lim_n T_n(x,0) = 0 \neq f(x)$, kun $x \neq 0 $. \loppu
\end{Exa}
Esimerkin mukaan kahdella eri funktiolla voi olla sama Taylorin sarja (esimerkiss‰ funktioilla 
$f$ ja $g=0$), joten Taylorin sarjan kertoimista (tai sarjan summasta) ei voi p‰‰tell‰ 
funktiota, josta sarja on johdettu. Useille 'normaaleille' funktioille $f$ kuitenkin p‰tee,
ett‰ $f$:n Taylorin sarjan summa $=f(x)$ aina kun sarja suppenee. T‰llaisia normaalitapauksia
ovat esim.\ rationaalifunktiot.
\begin{Exa}
Funktion $f(x)=1/(1+4x^2)$ Taylorin polynomit origossa ovat
\[
T_{2n}(x,0)=T_{2n+1}(x,0)=\sum_{k=0}^n (-4)^kx^{2k},\quad n=0,1,\ldots
\]
Taylorin sarja eli potenssisarja $\{T_n(x,0), \ n=0,1,2,\ldots\}$ suppenee t‰ss‰ tapauksessa
t‰sm‰lleen kun $\abs{x}<1/2$ (vrt.\ Luku \ref{potenssisarja}), ja t‰llˆin summa $=f(x)$\,:
\[
\sum_{k=0}^\infty (-4)^kx^{2k} = \frac{1}{1+4x^2} 
                               = f(x), \quad x \in (-\tfrac{1}{2},\,\tfrac{1}{2}\,). \loppu
\]
\end{Exa}

Taylorin sarjojen suppenemista tutkittaessa voidaan aina tehd‰ muuttujan vaihdos 
$x-x_0\hookrightarrow x$, jolloin riitt‰‰ tarkastella yleist‰ potenssisarjaa muotoa
\[ 
f(x) = \sum_{k=0}^n a_k x^k. 
\]
T‰llaisen sarjan suppenemiskysymys on ratkaistu Luvussa \ref{potenssisarja}: Lauseen 
\ref{suppenemiss‰de} mukaan sarja suppenee joko (a) vain kun $x=0$ tai (b) v‰lill‰ 
$(-\rho,\rho)$ (mahdollisesti myˆs kun $x = \pm \rho$), miss‰ $\rho$ on sarjan suppenemiss‰de
($\rho \in \R_+$ tai $\rho = \infty$). Luvussa \ref{derivaatta} osoitettiin, ett‰ 
potenssisarjan summana m‰‰ritelty funktio on mielivaltaisen monta kertaa derivoituva v‰lill‰ 
$(-\rho,\rho)$ ja ett‰ derivaatat voidaan laskea derivoimalla sarjaa termeitt‰in
(Lause \ref{potenssisarja on derivoituva}). N‰in ollen jos potenssisarjan
$\sum_{k=0}^\infty a_k x^k$ suppenemiss‰de on $\rho>0$ ja $x_0 \in \R$, niin funktio
\[ 
f(x) = \sum_{k=0}^\infty a_k\,(x-x_0)^k 
\]
on m‰‰ritelty ja mielivaltaisen monta kertaa derivoituva v‰lill‰ $(x_0-\rho,x_0+\rho)$ 
(koko $\R$:ss‰, jos $\rho=\infty$) ja $f$:n derivaatat voidaan laskea derivoimalla sarja 
termeitt‰in. Kun derivoimispisteeksi valitaan erityisesti $x_0$, saadaan tulos
\[
f^{(k)}(x_0) = k!\,a_k \qekv a_k = \frac{f^{(k)}(x_0)}{k!}, \quad k = 0,1,2, \ldots 
\]
Siis $f(x)$ on esitett‰viss‰ muodossa
\[
f(x) = \sum_{k=0}^\infty \frac{f^{(k)}(x_0)}{k!}\,(x-x_0)^k.
\]
On tultu seuraavaan huomionarvoiseen tulokseen:
\begin{Lause} Jos sarja $\,\sum_{k=0}^\infty a_k\,(x-x_0)^k\,$ suppenee v‰lill‰ 
$(x_0-\rho,x_0+\rho)$, $\rho>0$, niin ko.\ sarja = sarjan summana m‰‰ritellyn funktion
Taylorin sarja pisteess‰ $x_0$.
\end{Lause}
\begin{Exa} \label{sinx/x}
Funktion $\,\sin x\,$ sarjakehitelm‰st‰ n‰hd‰‰n, ett‰
\[
\sum_{k=0}^\infty (-1)^k\frac{x^{2k}}{(2k+1)!} = f(x) = \begin{cases}
                                                        \ \sin x/x\ , \ \ &x\neq 0, \\
                                                        \ 1\ ,            &x=0.
                                                        \end{cases}
\]
Koska sarja suppenee $\forall x\in\R$, niin kyseess‰ on sarjan summana m‰‰ritellyn funktion 
Taylorin sarja origossa. Funktio $f$ on siis mielivaltaisen monta kertaa derivoituva
jokaisessa pisteess‰ $x\in\R$, origo mukaan lukien (!). \loppu
\end{Exa}
\begin{Exa} Ratkaise Taylorin sarjoilla alkuarvoteht‰v‰
\[ \begin{cases} 
    \,y' = e^{-x^2}, \quad x \in \R, \\
    \,y(0) = 0.
\end{cases} \]
\end{Exa}
\ratk Koska eksponenttifunktion $e^x$ Taylorin sarja suppenee kaikkialla, niin
\[ 
e^{-x^2}\ =\ \sum_{k=0}^\infty \frac{(-x^2)^k}{k!}\ 
          =\ \sum_{k=0}^\infty \frac{(-1)^k}{k!}\,x^{2k}\,, \quad x \in \R. 
\]
Kun valitaan
\[ 
y(x)\ =\ \sum_{k=0}^\infty \frac{(-1)^k}{(2k+1)\,k!}\,x^{2k+1}\ 
      =\ x - \frac{x^3}{18} + \frac{x^5}{600} - \ldots, 
\]
niin n‰hd‰‰n termeitt‰in derivoimalla, ett‰ $y'(x)=e^{-x^2},\ x\in\R$. Koska on myˆs $y(0)=0$,
niin ratkaisu on t‰ss‰. \loppu

\subsection*{*Kompleksinen potenssisarja}

\kor{Kompleksiseksi potenssisarjaksi} sanotaan sarjaa muotoa 
$\,\sum_{k=0}^\infty a_k (z-z_0)^k$, miss‰ $a_k,\,z_0 \in \C$ ja $z$ on kompleksimuuttuja. 
T‰llaisen sarjan suppenemisteoria on samanlainen kuin reaalisen vastineensa, sill‰ Luvun 
\ref{potenssisarja} suppenemistarkastelut perustuvat viime k‰dess‰ vain kunta-algebraan ja 
lukujen \pain{itseisarvo}j\pain{en} vertailuun. N‰m‰ operaatiot eiv‰t muutu siirrytt‰ess‰ 
kompleksilukujen kuntaan. Esimerkiksi sarjan itseinen suppeneminen m‰‰ritell‰‰n samoin kuin 
reaalisille sarjoille:
\[ 
\sum_{k=0}^\infty a_k z^k\ \text{suppenee itseisesti} 
              \qekv \sum_{k=0}^\infty \abs{a_k}\abs{z}^k\ \text{suppenee}. 
\]
Potenssisarjojen teorian keskeisin tulos, Lause \ref{suppenemiss‰de}, s‰ilytt‰‰ n‰in ollen 
p‰tevyytens‰: Kompleksinenkin sarja muotoa $\sum_{k=0}^\infty a_k (z-z_0)^k$ suppenee, myˆs 
itseisesti, kun $\abs{z-z_0}<\rho$, ja hajaantuu kun $\abs{z-z_0}>\rho$, miss‰ $\rho$ on 
suppenemiss‰de ($\rho=0$, $\rho \in \R_+$ tai $\rho=\infty$). Jos $\rho>0$, niin sarja siis 
suppenee kompleksitason avoimessa kiekossa
\[ 
A = \{z \in \C \mid \abs{z-z_0} < \rho\}. 
\]
Myˆs Lause \ref{potenssisarja on derivoituva} s‰ilyy voimassa kompleksialueella, sill‰ t‰m‰kin
perustuu vain kunta-algebraan ja itseisarvojen vertailuun, kuten todistus 
(ks.\ Luku \ref{derivaatta}) osoittaa. Potenssisarjan summana m‰‰ritelty funktio $f$
on siis analyyttinen ym.\ avoimessa kiekossa $A$ (M‰‰ritelm‰ \ref{analyyttinen funktio}), ja
kuten reaalisen sarjan tapauksessa p‰tee
\[
f(z) = \sum_{k=0}^\infty a_k\,(z-z_0)^k 
     = \sum_{k=0}^\infty \dfrac{f^{(k)}(z_0)}{k!}\,(z-z_0)^k, \quad z \in A.
\]
Jos suppenemiss‰de on $\rho=\infty$, niin $A=\C$ ja $f$ siis kokonainen funktio. Polynomien
lis‰ksi kokonaisia funktioita ovat esimerkiksi Luvussa \ref{kompleksinen eksponenttifunktio}
m‰‰ritellyt funktiot $e^z$, $\cos z$, $\sin z$, $\cosh z$ ja $\sinh z$. N‰iden funktioiden
potenssisarjat origossa ($z_0=0$) saadaan yksinkertaisesti vaihtamalla reaalisessa Taylorin
sarjassa muuttujaksi $z\,$:

\[ \boxed{ \begin{aligned}
  \ykehys e^z\ &=\ \sum_{k=0}^\infty \frac{z^k}{k!} \\
     \cos z\ \ &=\ \sum_{k=0}^\infty (-1)^k \frac{z^{2k}}{(2k)!} \qquad\quad 
    \sin z\,\ \ =\ \sum_{k=0}^\infty (-1)^k \frac{z^{2k+1}}{(2k+1)!} \quad \\
\quad \cosh z\ &=\ \sum_{k=0}^\infty \frac{z^{2k}}{(2k)!} \qquad\qquad\quad\,\
       \sinh z\ =\ \sum_{k=0}^\infty \frac{z^{2k+1}}{(2k+1)!} \akehys
           \end{aligned} } \]
\begin{Exa} Jos $x\in\R$, niin Eulerin kaavan
(ks.\ Luku \ref{kompleksinen eksponenttifunktio}) ja $e^z$:n potenssisarjan perusteella p‰tee
\begin{align*}
\cos x + i\sin x\ =\ e^{ix}\ &=\ \sum_{k=0}^\infty \frac{(ix)^k}{k!} \\
                            &=\ \left(1-\frac{x^2}{2!}+\frac{x^4}{4!}- \ldots \right)
                              + i\left(x-\frac{x^3}{3!}+\frac{x^5}{5!}- \ldots \right) \\[2mm]
\impl\quad \cos x = 1-\frac{x^2}{2!}&+\frac{x^4}{4!}-\ldots\,, \quad \sin x 
                  = x-\frac{x^3}{3!}+\frac{x^5}{5!}-\ldots\,, \quad x\in\R.
\end{align*}
Tulos tiedettiin jo Taylorin lauseenkin perusteella. \loppu
\end{Exa}
\begin{Exa} Funktio 
\[ 
f(z) = \begin{cases}  \ \sin z/z\ ,\ \ &z \neq 0 \\ \ 1\ , &z=0 \end{cases} 
\]
on kokonainen funktio. Esimerkiss‰ \ref{sinx/x} esitetty funktion potenssisarja on p‰tev‰ myˆs
kompleksialueella, eli sarjassa voidaan $x$:n tilalle kirjoittaa $z \in \C$. 
\loppu \end{Exa}
\begin{Exa} \label{kompleksinen sarja} Funktion $f(z) = 1/(1+z^2)$ sarjakehitelm‰
\[ f(z) = \sum_{k=0}^\infty (-1)^k z^{2k} \]
on p‰tev‰ kun $\abs{z}<1$ (suppenemisss‰de $\rho=1$). \loppu
\end{Exa}
Kun Esimerkin \ref{kompleksinen sarja} funktiota verrataan funktioon $e^{-z^2}$, niin
havaitaan, ett‰ reaalisilla muuttujan arvoilla molemmat funktiot ovat sileit‰ ja funktioiden
kuvaajatkin ovat melko samann‰kˆisi‰. Funktioiden Taylorin sarjat pisteess‰
$x_0=0$ ovat kuitenkin hyvin erilaiset, sill‰ funktion $f(x) = 1/(1+x^2)$ sarja suppenee vain
v‰lill‰ $(-1,1)$, kun funktion $f(x) = e^{-x^2}$ sarja suppenee kaikkialla. T‰h‰n ilmiˆˆn voi
n‰hd‰ kompleksisen selityksen: Funktiolla $1/(1+x^2)$ on 'luurankoja kaapissaan', sill‰
kompleksifunktiona $1/(1+z^2)$ sill‰ on nk.\ \kor{napa} (engl.\ pole) pisteiss‰ $i$ ja $-i$.
Funktion $e^{-x^2}$ kompleksinen vastine $e^{-z^2}$ sen sijaan on kokonainen funktio, eli
s‰‰nnˆllinen myˆs kompleksifunktiona. --- Myˆs Esimerkin \ref{outo Taylorin sarja} funktio
paljastaa paremmin todellisen luonteensa, kun muuttujasta tehd‰‰n kompleksinen: Funktio
\[ 
f(z) = e^{-1/z^2},\ \ z \in \C,\ z \neq 0 
\]
ei ole origon ymp‰ristˆss‰ edes rajoitettu, sill‰ $f(iy) = e^{1/y^2} \kohti \infty$, kun 
$y \kohti 0$.  

Esitet‰‰n kauniiksi lopuksi funktioteorian v‰itt‰m‰, joka yhdist‰‰ analyyttisyyden k‰sitteen 
potenssisarjoihin. (V‰itt‰m‰‰ ei todisteta.)
\begin{*Lause} \label{funktioteorian v‰itt‰m‰} Jos $G \subset \C$ on avoin joukko, niin 
kompleksifunktio $f$ on analyyttinen joukossa $G$ t‰sm‰lleen kun jokaisen pisteen $z_0 \in G$
jokaisessa sellaisessa ymp‰ristˆss‰ $U_{\delta}(z_0) = \{z \in \C \mid \abs{z-z_0} < \delta\}$, 
jolle p‰tee $U_\delta(z_0) \subset G$, $f(z)$ on esitett‰viss‰ suppenevana potenssisarjana:
\[ 
f(z)\ =\ \sum_{k=0}^\infty a_k\,(z-z_0)^k\ 
   =\ \sum_{k=0}^\infty \frac{f^{(k)}(z_0)}{k!}\,(z-z_0)^k, \quad z \in U_\delta(z_0) \subset G.
\]
\end{*Lause}
\jatko \begin{Exa} (jatko) Esimerkin funktio $f$ on analyyttinen joukossa 
\[ 
G = \{z \in \C \mid z \neq \pm i\,\}.
\]
Jos $z_0=0$, niin $U_\delta(z_0) \subset G$ t‰sm‰lleen kun $\delta<1$. Funktion $f$ 
potenssisarja origossa myˆs suppenee jokaisessa t‰llaisessa origon ymp‰ristˆss‰, kuten Lause
\ref{funktioteorian v‰itt‰m‰} v‰itt‰‰. \loppu 
\end{Exa}

\Harj
\begin{enumerate}

\item
Mik‰ on sarjan
\[
\text{a)}\,\ 1+4+\frac{16}{2!}+\frac{64}{3!}+\frac{256}{4!}+ \ldots \quad\
\text{b)}\,\ 1+\frac{4}{3!}+\frac{16}{5!}+\frac{64}{7!}+ \ldots  
\]
summa?

\item
Esit‰ seuraavien funktioiden funktioiden Taylorin sarjat
pisteess‰ $x_0=0\,$: \vspace{1mm}\newline
a) \ $e^{3x+1}\quad$ 
b) \ $\cos(2x^3)\quad$ 
c) \ $\sin(x-\frac{\pi}{4})\quad$ 
d) \ $\cos(2x-\pi)\quad$ 
e) \ $x^2\sin 3x$\vspace{1mm}\newline
f) \ $\sin x\cos x\quad$ 
g) \ $(1+x^3)/(1+x^2)\quad$ 
h) \ $\ln(2+x^2)\quad$ 
i) \ $x^2\ln(1+x)$

\item
M‰‰rit‰ seuraavien funktioiden Taylorin sarja annetussa pisteess‰ sek‰ sarjan
suppenemisv‰li: \vspace{1mm}\newline
a) \ $e^{-2x},\,\ x_0=-1 \qquad$
b) \ $\sin x,\,\ x_0=\tfrac{\pi}{2} \qquad\,\ $
c) \ $\ln x,\,\ x_0=1$ \newline
d) \ $\cos x,\,\ x_0=\pi \qquad\,\ $
e) \ $\cos^2 x,\,\ x_0=\tfrac{\pi}{8} \qquad$ 
f) \ $x/(4+x),\,\ x_0=3$

\item
Olkoon
\[
f(x)= \begin{cases} 
      \dfrac{2\cos x-2}{x^2}\,, &\text{kun}\ x \neq 0 \\[2mm] -1, &\text{kun}\ x=0
      \end{cases}
\]
Laske $f'(0)$ ja $f''(0)$ \ a) suoraan derivaatan m‰‰ritelm‰st‰, \ b) $f$:n Taylorin sarjan
avulla.

\item
Seuraavat funktiot $f$ m‰‰ritell‰‰n kukin jatkuvaksi pisteess‰ $x=0$, jolloin funktiot ovat
t‰ss‰ pisteess‰ (ja siis koko $\R$:ss‰) mielivaltaisen monta kertaa derivoituvia. M‰‰rit‰
funktioiden Taylorin sarjat pistees‰ $x_0=0$ ja n‰iden avulla $f(0)$, $f'(0)$ ja $f''(0)$.
Selvit‰ myˆs pisteen $x=0$ laatu mahdollisena funktion paikallisena ‰‰riarvokohtana.
\begin{align*}
&\text{a)}\ \ \frac{e^x-1}{x} \qquad 
 \text{b)}\ \ \frac{e^{-2x}-1+2x-2x^2}{x^3} \qquad
 \text{c)}\ \ \frac{\sinh x-x}{x^3} \\
&\text{d)}\ \ \frac{\ln(1+x)-\sin x}{x^2} \qquad
 \text{e)}\ \ \frac{e^{2x}-4e^{-x}-6x+3}{x^2}
\end{align*}

\item
Tiedet‰‰n, ett‰
\[
\sum_{k=0}^\infty a_k(z+i)^k\,=\,z\cos z, \quad z\in\C.
\]
Laske sarjan kertoimet $a_0$, $a_1$ ja $a_2$.

\item
Kompleksinen potenssisarja $\sum_{k=0}^\infty a_k z^k$ suppenee origon l‰hell‰ ja sarjan
summa on
\[
\sum_{k=0}^\infty a_k z^k\,=\,\frac{1}{z^2+(1+i)z+2+2i}\,.
\]
Mik‰ on sarjan suppenemiss‰de, ja mitk‰ ovat kertoimien $a_0$ ja $a_1$ arvot?

\end{enumerate}

